<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Typowanie Mistrzostw ≈öwiata</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f2f2f2;
    }
    h1 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    .green { background-color: #4CAF50; color: white; }
    .orange { background-color: #FFA500; color: white; }
    .red { background-color: #FF6347; color: white; }
    #mecze-table {
      margin-top: 40px;
    }
    .match-row {
      padding: 10px;
    }
    #round-selector {
      margin: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>üèÜ Typowanie Mistrzostw ≈öwiata</h1>

  <!-- Wyb√≥r rundy -->
  <div id="round-selector">
    <h3>Wybierz rundƒô:</h3>
    <select id="round">
      <option value="group">Runda Grupowa</option>
      <option value="quarter">ƒÜwierƒáfina≈Çy</option>
      <option value="semi">P√≥≈Çfina≈Çy</option>
      <option value="final">Fina≈Ç</option>
    </select>
    <button onclick="loadData()">Zastosuj</button>
  </div>

  <!-- Wyniki -->
  <h2>üèÖ Aktualna tabela wynik√≥w</h2>
  <div id="table-container"></div>

  <!-- Mecz√≥w -->
  <h2>‚öΩ Wyniki mecz√≥w i typy uczestnik√≥w</h2>
  <div id="mecze-table"></div>

  <script type="application/json" id="mecze">[
    { "id": 1, "team1": "Argentyna", "team2": "Polska", "date": "2022-12-18", "round": "group", "score1": 3, "score2": 1 },
    { "id": 2, "team1": "Argentyna", "team2": "Francja", "date": "2022-12-18", "round": "quarter", "score1": 3, "score2": 1 },
    { "id": 3, "team1": "Brazylia", "team2": "Niemcy", "date": "2022-12-17", "round": "semi", "score1": null, "score2": null },
    { "id": 4, "team1": "Francja", "team2": "Anglia", "date": "2022-12-17", "round": "final", "score1": null, "score2": null }
  ]</script>

  <script type="application/json" id="uczestnicy">[ 
    { 
      "name": "Ania", 
      "winner": "Brazylia", 
      "predictions": {
        "1": { "score1": 3, "score2": 1 },
        "2": { "score1": 7, "score2": 2 },
        "3": { "score1": 2, "score2": 2 }
      }
    },
    {
      "name": "Kuba",
      "winner": "Francja",
      "predictions": {
        "1": { "score1": 1, "score2": 7 },
        "2": { "score1": 1, "score2": 2 },
        "3": { "score1": 2, "score2": 3 }
      }
    }
  ]</script>

  <script type="application/json" id="kraje">{
    "Argentyna": "ar",
    "Francja": "fr",
    "Brazylia": "br",
    "Niemcy": "de",
    "Hiszpania": "es",
    "Anglia": "gb",
    "W≈Çochy": "it",
    "Holandia": "nl",
    "Portugalia": "pt",
    "Belgia": "be",
    "Chorwacja": "hr",
    "Urugwaj": "uy",
    "Szwajcaria": "ch",
    "Dania": "dk",
    "Stany Zjednoczone": "us"
  }</script>

  <script>
    function loadData() {
      const mecze = JSON.parse(document.getElementById("mecze").textContent);
      const uczestnicy = JSON.parse(document.getElementById("uczestnicy").textContent);
      const kraje = JSON.parse(document.getElementById("kraje").textContent);

      const round = document.getElementById("round").value;

      // Filtrowanie mecz√≥w na podstawie wybranej rundy
      const filteredMecze = mecze.filter(mecz => mecz.round === round);

      // Wyniki meczu
      const wyniki = {};
      mecze.forEach(mecz => {
        if (mecz.score1 !== null && mecz.score2 !== null) {
          wyniki[mecz.id] = [mecz.score1, mecz.score2];
        }
      });

      // Obliczanie punkt√≥w dla uczestnik√≥w
      const tabela = uczestnicy.map(u => {
        let punkty = 0;
        Object.entries(u.predictions).forEach(([id, typ]) => {
          const wynik = wyniki[id];
          if (!wynik) return;
          const [rzeczywisty1, rzeczywisty2] = wynik;
          if (typ.score1 === rzeczywisty1 && typ.score2 === rzeczywisty2) {
            punkty += 3; // 3 punkty za dok≈Çadny wynik
          } else if ((typ.score1 > typ.score2 && rzeczywisty1 > rzeczywisty2) ||
                     (typ.score1 < typ.score2 && rzeczywisty1 < rzeczywisty2) ||
                     (typ.score1 === typ.score2 && rzeczywisty1 === rzeczywisty2)) {
            punkty += 1; // 1 punkt za dobry typ wyniku
          }
        });

        return {
          name: u.name,
          flaga: kraje[u.winner] || "",
          punkty,
          suma: punkty
        };
      });

      // Sortowanie uczestnik√≥w po punktach
      tabela.sort((a, b) => b.suma - a.suma);

      // Wy≈õwietlanie tabeli uczestnik√≥w
      const container = document.getElementById("table-container");
      const table = document.createElement("table");
      table.innerHTML = `
        <thead>
          <tr>
            <th>Uczestnik</th>
            <th>Flaga</th>
            <th>Punkty</th>
            <th>Suma</th>
          </tr>
        </thead>
        <tbody>
          ${tabela.map(u => `
            <tr>
              <td>${u.name}</td>
              <td>${u.flaga ? `<img src="https://flagcdn.com/24x18/${u.flaga}.png" alt="${u.flaga}" />` : ""}</td>
              <td>${u.punkty}</td>
              <td>${u.suma}</td>
            </tr>
          `).join("")}
        </tbody>
      `;
      container.appendChild(table);

      // Wy≈õwietlanie mecz√≥w dla wybranej rundy
      const meczeTable = document.getElementById("mecze-table");
      const meczTable = filteredMecze.map(mecz => {
        const date = new Date(mecz.date);
        const matchDate = `${date.getDate()}.${date.getMonth() + 1}.${date.getFullYear()} ${date.getHours()}:${date.getMinutes()}`;
        return `
          <div class="match-row">
            <strong>${matchDate}</strong> - ${mecz.team1} vs ${mecz.team2}  
            ${wyniki[mecz.id] ? `| Wynik: ${wyniki[mecz.id][0]} - ${wyniki[mecz.id][1]}` : "| Wynik: Oczekiwany"}
          </div>
        `;
      }).join('');
      
      meczeTable.innerHTML = meczTable;
    }

    loadData();
  </script>
</body>
</html>
